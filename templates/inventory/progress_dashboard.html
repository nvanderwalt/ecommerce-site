{% extends "base.html" %}
{% load static %}

{% block title %}My Progress - FitFusion{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <h1 class="text-center mb-4">
                <i class="fas fa-chart-line text-success me-2"></i>My Progress Dashboard
            </h1>
            
            <!-- Overall Progress -->
            <div class="card mb-4">
                <div class="card-header bg-success text-white">
                    <h3 class="mb-0">
                        <i class="fas fa-trophy me-2"></i>Overall Progress
                    </h3>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h5>Exercise Plans</h5>
                            <p>{{ completed_exercise_plans }} of {{ total_exercise_plans }} completed</p>
                        </div>
                        <div class="col-md-6">
                            <h5>Nutrition Plans</h5>
                            <p>{{ completed_nutrition_plans }} of {{ total_nutrition_plans }} completed</p>
                        </div>
                    </div>
                    <div class="progress mt-3">
                        <div class="progress-bar bg-success" role="progressbar" 
                             style="width: {{ overall_progress }}%" 
                             aria-valuenow="{{ overall_progress }}" 
                             aria-valuemin="0" 
                             aria-valuemax="100">
                            {{ overall_progress|floatformat:1 }}%
                        </div>
                    </div>
                </div>
            </div>

            <!-- Exercise Plans Progress -->
            {% if exercise_progress %}
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h3 class="mb-0">
                        <i class="fas fa-dumbbell me-2"></i>Exercise Plans Progress
                    </h3>
                </div>
                <div class="card-body">
                    {% for progress in exercise_progress %}
                    <div class="row mb-3 align-items-center">
                        <div class="col-md-6">
                            <h5>{{ progress.plan.name }}</h5>
                            <small class="text-muted">Started: {{ progress.start_date|date:"M j, Y" }}</small>
                        </div>
                        <div class="col-md-6">
                            <div class="progress">
                                <div class="progress-bar bg-primary" role="progressbar" 
                                     style="width: {{ progress.get_progress_percentage }}%" 
                                     aria-valuenow="{{ progress.get_progress_percentage }}" 
                                     aria-valuemin="0" 
                                     aria-valuemax="100">
                                    {{ progress.get_progress_percentage|floatformat:1 }}%
                                </div>
                            </div>
                            {% if progress.is_completed %}
                            <small class="text-success">
                                <i class="fas fa-check-circle me-1"></i>Completed on {{ progress.completion_date|date:"M j, Y" }}
                            </small>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- Nutrition Plans Progress -->
            {% if nutrition_progress %}
            <div class="card mb-4">
                <div class="card-header bg-warning text-dark">
                    <h3 class="mb-0">
                        <i class="fas fa-apple-alt me-2"></i>Nutrition Plans Progress
                    </h3>
                </div>
                <div class="card-body">
                    {% for progress in nutrition_progress %}
                    <div class="row mb-3 align-items-center">
                        <div class="col-md-6">
                            <h5>{{ progress.plan.name }}</h5>
                            <small class="text-muted">Started: {{ progress.start_date|date:"M j, Y" }}</small>
                        </div>
                        <div class="col-md-6">
                            <div class="progress">
                                <div class="progress-bar bg-warning" role="progressbar" 
                                     style="width: {{ progress.get_progress_percentage }}%" 
                                     aria-valuenow="{{ progress.get_progress_percentage }}" 
                                     aria-valuemin="0" 
                                     aria-valuemax="100">
                                    {{ progress.get_progress_percentage|floatformat:1 }}%
                                </div>
                            </div>
                            {% if progress.is_completed %}
                            <small class="text-success">
                                <i class="fas fa-check-circle me-1"></i>Completed on {{ progress.completion_date|date:"M j, Y" }}
                            </small>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- Call to Action -->
            {% if not exercise_progress and not nutrition_progress %}
            <div class="text-center">
                <h4 class="text-muted mb-3">No progress yet!</h4>
                <p class="text-muted mb-4">Start your fitness journey by enrolling in exercise and nutrition plans.</p>
                <div class="d-flex justify-content-center gap-3">
                    <a href="{% url 'exercise_plan_list' %}" class="btn btn-primary">
                        <i class="fas fa-running me-2"></i>Browse Exercise Plans
                    </a>
                    <a href="{% url 'subscriptions:plan_list' %}" class="btn btn-success">
                        <i class="fas fa-crown me-2"></i>View Subscriptions
                    </a>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %} 